# =============================================================================
# AI Multi-Model Platform - Disaster Recovery Configuration
# Enterprise disaster recovery and system restoration configuration
# =============================================================================

# General DR Configuration
DR_ENABLED=true
DR_ENVIRONMENT="production"  # production, staging, development
DR_SITE_TYPE="primary"       # primary, secondary, tertiary
DR_REGION="us-east-1"
DR_AVAILABILITY_ZONE="us-east-1a"

# Recovery Objectives
RTO_CRITICAL=15     # Recovery Time Objective for critical systems (minutes)
RTO_HIGH=60         # Recovery Time Objective for high priority systems (minutes)
RTO_MEDIUM=240      # Recovery Time Objective for medium priority systems (minutes)
RTO_LOW=1440        # Recovery Time Objective for low priority systems (minutes)

RPO_CRITICAL=5      # Recovery Point Objective for critical systems (minutes)
RPO_HIGH=15         # Recovery Point Objective for high priority systems (minutes)
RPO_MEDIUM=60       # Recovery Point Objective for medium priority systems (minutes)
RPO_LOW=240         # Recovery Point Objective for low priority systems (minutes)

# Recovery Workspace Configuration
RECOVERY_WORKSPACE="/tmp/disaster-recovery"
RECOVERY_TEMP_SIZE="50G"     # Minimum space required for recovery operations
RECOVERY_CLEANUP_DELAY=7200  # Keep workspace for debugging (seconds)
RECOVERY_PARALLEL_JOBS=4

# Backup Source Configuration
PRIMARY_BACKUP_LOCATION="/var/backups/ai-platform"
SECONDARY_BACKUP_LOCATION="s3://ai-platform-backups"
TERTIARY_BACKUP_LOCATION="gs://ai-platform-backups-secondary"
BACKUP_RETENTION_CRITICAL=90  # days
BACKUP_RETENTION_NORMAL=30    # days

# Database Recovery Configuration
DB_RECOVERY_HOST="localhost"
DB_RECOVERY_PORT=5432
DB_RECOVERY_USER="postgres"
DB_RECOVERY_ADMIN_USER="postgres"
DB_RECOVERY_TIMEOUT=1800      # seconds
DB_RECOVERY_PARALLEL_JOBS=4
DB_RECOVERY_VALIDATE_RESTORE=true
DB_RECOVERY_CREATE_MISSING_DBS=true
DB_RECOVERY_SKIP_GRANTS=false

# Redis Recovery Configuration
REDIS_RECOVERY_HOST="localhost"
REDIS_RECOVERY_PORT=6379
REDIS_RECOVERY_DATA_DIR="/var/lib/redis"
REDIS_RECOVERY_TIMEOUT=600    # seconds
REDIS_RECOVERY_VALIDATE_RESTORE=true
REDIS_RECOVERY_FLUSH_BEFORE_RESTORE=true

# Application Recovery Configuration
APP_RECOVERY_ROOT="/opt/ai-platform"
APP_RECOVERY_USER="ai-platform"
APP_RECOVERY_GROUP="ai-platform"
APP_RECOVERY_TIMEOUT=1800     # seconds
APP_RECOVERY_VALIDATE_DEPENDENCIES=true
APP_RECOVERY_RESTART_SERVICES=true
APP_RECOVERY_HEALTH_CHECK_URL="http://localhost:8080/health"
APP_RECOVERY_HEALTH_CHECK_TIMEOUT=300
APP_RECOVERY_HEALTH_CHECK_RETRIES=5

# Configuration Recovery
CONFIG_RECOVERY_BACKUP_CURRENT=true
CONFIG_RECOVERY_VALIDATE_SYNTAX=true
CONFIG_RECOVERY_RESTART_SERVICES=true
CONFIG_RECOVERY_TIMEOUT=600   # seconds

# Service Dependencies and Order
RECOVERY_SERVICE_ORDER="postgresql,redis,nginx,ai-platform-api,ai-platform-web,ai-platform-workers"
SERVICE_START_DELAY=30        # seconds between service starts
SERVICE_HEALTH_CHECK_TIMEOUT=60
SERVICE_HEALTH_CHECK_RETRIES=3

# Network and DNS Configuration
ENABLE_DNS_FAILOVER=true
DNS_FAILOVER_TTL=60           # seconds
LOAD_BALANCER_FAILOVER=true
FAILOVER_IP_ADDRESS=""
FAILOVER_DNS_RECORDS=""       # comma-separated list

# Storage Recovery Configuration
STORAGE_RECOVERY_VALIDATE_INTEGRITY=true
STORAGE_RECOVERY_CHECKSUM_VALIDATION=true
STORAGE_RECOVERY_PARALLEL_RESTORE=true
STORAGE_RECOVERY_BANDWIDTH_LIMIT=""  # e.g., "100M" for 100MB/s

# Security Configuration During Recovery
SECURITY_RECOVERY_MODE="strict"  # strict, relaxed, emergency
EMERGENCY_ACCESS_ENABLED=false
EMERGENCY_ACCESS_DURATION=3600    # seconds
SECURITY_VALIDATION_REQUIRED=true
CERTIFICATE_VALIDATION_REQUIRED=true

# Monitoring During Recovery
MONITORING_RECOVERY_ENABLED=true
MONITORING_RECOVERY_INTERVAL=30   # seconds
MONITORING_RECOVERY_METRICS_RETENTION=7  # days
RECOVERY_DASHBOARD_ENABLED=true
RECOVERY_DASHBOARD_PORT=9091

# Notification Configuration
NOTIFICATION_RECOVERY_ENABLED=true
NOTIFICATION_RECOVERY_CHANNELS="email,slack,teams,pagerduty"
NOTIFICATION_RECOVERY_URGENCY="high"
NOTIFICATION_RECOVERY_ESCALATION_TIMEOUT=900  # seconds

# DR Testing Configuration
DR_TEST_ENABLED=true
DR_TEST_SCHEDULE="monthly"    # weekly, monthly, quarterly, annually
DR_TEST_ENVIRONMENT="staging"
DR_TEST_COMPONENTS="all"      # all, database, application, configuration
DR_TEST_AUTOMATED=true
DR_TEST_DURATION_LIMIT=14400  # seconds (4 hours)
DR_TEST_CLEANUP_AUTOMATIC=true

# DR Test Validation
DR_TEST_VALIDATE_DATABASE=true
DR_TEST_VALIDATE_APPLICATION=true
DR_TEST_VALIDATE_MONITORING=true
DR_TEST_VALIDATE_PERFORMANCE=true
DR_TEST_PERFORMANCE_THRESHOLD=0.8  # 80% of normal performance
DR_TEST_REPORT_GENERATION=true

# Communication Plan
COMMUNICATION_PLAN_ENABLED=true
COMMUNICATION_STAKEHOLDERS="management,engineering,operations,security"
COMMUNICATION_FREQUENCY_NORMAL=3600    # seconds (1 hour)
COMMUNICATION_FREQUENCY_CRITICAL=900   # seconds (15 minutes)
COMMUNICATION_CHANNELS="email,slack,teams,phone"

# Emergency Contacts
EMERGENCY_CONTACT_DBA=""
EMERGENCY_CONTACT_SYSADMIN=""
EMERGENCY_CONTACT_SECURITY=""
EMERGENCY_CONTACT_MANAGEMENT=""
EMERGENCY_CONTACT_VENDOR_SUPPORT=""
ESCALATION_MATRIX_FILE="/etc/ai-platform/escalation-matrix.json"

# Rollback Configuration
ROLLBACK_ENABLED=true
ROLLBACK_AUTOMATIC_TRIGGERS="health_check_failure,performance_degradation"
ROLLBACK_TIMEOUT=1800         # seconds
ROLLBACK_VALIDATE_ORIGINAL_STATE=true
ROLLBACK_PRESERVE_RECOVERY_LOGS=true

# Data Validation During Recovery
DATA_VALIDATION_ENABLED=true
DATA_VALIDATION_SAMPLE_SIZE=1000   # number of records to validate
DATA_VALIDATION_QUERIES_FILE="/etc/ai-platform/dr-validation-queries.sql"
DATA_VALIDATION_TIMEOUT=600        # seconds
DATA_VALIDATION_CRITICAL_TABLES="users,organizations,api_keys,billing"

# Performance Optimization During Recovery
RECOVERY_CPU_PRIORITY="high"       # low, normal, high
RECOVERY_IO_PRIORITY="high"        # low, normal, high
RECOVERY_MEMORY_LIMIT=""           # e.g., "4G"
RECOVERY_BANDWIDTH_PRIORITIZATION=true

# Logging and Auditing
DR_AUDIT_LOGGING=true
DR_AUDIT_LOG_FILE="/var/log/ai-platform/disaster-recovery-audit.log"
DR_LOG_LEVEL="INFO"                # DEBUG, INFO, WARN, ERROR
DR_LOG_RETENTION_DAYS=90
DR_CENTRALIZED_LOGGING=true
DR_LOG_SHIPPING_ENABLED=true

# Compliance and Regulatory
COMPLIANCE_LOGGING_REQUIRED=true
COMPLIANCE_RECOVERY_DOCUMENTATION=true
REGULATORY_NOTIFICATION_REQUIRED=false
REGULATORY_NOTIFICATION_TIMEFRAME=24  # hours
REGULATORY_CONTACTS=""

# Geographic Distribution
GEOGRAPHIC_FAILOVER_ENABLED=false
SECONDARY_SITE_LOCATION=""
TERTIARY_SITE_LOCATION=""
CROSS_REGION_REPLICATION=false
GLOBAL_LOAD_BALANCER=""

# Cloud Provider Specific Configuration
# AWS Configuration
AWS_DR_REGION="us-west-2"
AWS_VPC_ID=""
AWS_SUBNET_IDS=""
AWS_SECURITY_GROUP_IDS=""
AWS_IAM_ROLE=""
AWS_KMS_KEY_ID=""

# Google Cloud Configuration
GCP_DR_REGION="us-west1"
GCP_PROJECT_ID=""
GCP_VPC_NETWORK=""
GCP_SUBNET=""
GCP_SERVICE_ACCOUNT=""

# Azure Configuration
AZURE_DR_REGION="West US 2"
AZURE_RESOURCE_GROUP=""
AZURE_VNET=""
AZURE_SUBNET=""
AZURE_SERVICE_PRINCIPAL=""

# Container Orchestration Recovery
KUBERNETES_RECOVERY_ENABLED=true
K8S_NAMESPACE="ai-platform"
K8S_RECOVERY_STRATEGY="rolling"    # rolling, blue-green, recreate
K8S_RECOVERY_TIMEOUT=1800          # seconds
K8S_VALIDATE_PODS=true
K8S_VALIDATE_SERVICES=true
K8S_VALIDATE_INGRESS=true

# Docker Recovery
DOCKER_RECOVERY_ENABLED=true
DOCKER_REGISTRY_URL=""
DOCKER_REGISTRY_USERNAME=""
DOCKER_REGISTRY_PASSWORD=""
DOCKER_PULL_POLICY="always"       # always, if-not-present, never
DOCKER_NETWORK_RECOVERY=true

# Load Balancer Recovery
LB_RECOVERY_ENABLED=true
LB_HEALTH_CHECK_INTERVAL=30        # seconds
LB_HEALTH_CHECK_TIMEOUT=10         # seconds
LB_HEALTH_CHECK_RETRIES=3
LB_FAILOVER_AUTOMATIC=true
LB_FAILOVER_THRESHOLD=2            # number of failed health checks

# CDN Recovery
CDN_RECOVERY_ENABLED=false
CDN_PROVIDER=""                    # cloudflare, fastly, amazon, google
CDN_PURGE_CACHE=true
CDN_FAILOVER_ORIGIN=""

# Backup Validation Before Recovery
BACKUP_VALIDATION_REQUIRED=true
BACKUP_INTEGRITY_CHECK=true
BACKUP_COMPLETENESS_CHECK=true
BACKUP_AGE_CHECK=true
BACKUP_MAX_AGE_HOURS=24            # Maximum acceptable backup age

# Recovery Performance Metrics
RECOVERY_METRICS_ENABLED=true
RECOVERY_METRICS_COLLECTION_INTERVAL=10  # seconds
RECOVERY_PERFORMANCE_BASELINE_FILE="/etc/ai-platform/recovery-baseline.json"
RECOVERY_SLA_MONITORING=true

# Advanced Recovery Features
INCREMENTAL_RECOVERY_ENABLED=true
POINT_IN_TIME_RECOVERY_ENABLED=true
CROSS_PLATFORM_RECOVERY_ENABLED=false
AUTOMATED_RECOVERY_ENABLED=false   # Requires extensive testing
RECOVERY_SIMULATION_MODE=false

# Custom Recovery Scripts
CUSTOM_PRE_RECOVERY_SCRIPT=""
CUSTOM_POST_RECOVERY_SCRIPT=""
CUSTOM_VALIDATION_SCRIPT=""
CUSTOM_ROLLBACK_SCRIPT=""
CUSTOM_NOTIFICATION_SCRIPT=""

# Resource Requirements
MIN_CPU_CORES=4
MIN_MEMORY_GB=16
MIN_DISK_SPACE_GB=100
MIN_NETWORK_BANDWIDTH_MBPS=100
REQUIRED_PORTS="22,80,443,5432,6379,8080,9090,9091"

# Recovery Environment Variables
RECOVERY_ENV_FILE="/etc/ai-platform/recovery.env"
RECOVERY_SECRETS_FILE="/etc/ai-platform/recovery-secrets.env"
RECOVERY_CONFIG_TEMPLATE_DIR="/etc/ai-platform/recovery-templates"

# Quality Assurance
QA_VALIDATION_ENABLED=true
QA_TEST_SUITE_LOCATION="/opt/ai-platform/tests/dr"
QA_AUTOMATED_TESTING=true
QA_PERFORMANCE_TESTING=true
QA_SECURITY_TESTING=true
QA_REPORT_GENERATION=true

# Documentation and Procedures
RUNBOOK_LOCATION="/opt/ai-platform/docs/disaster-recovery"
PROCEDURE_DOCUMENTATION_REQUIRED=true
RECOVERY_CHECKLIST_FILE="/etc/ai-platform/recovery-checklist.json"
POST_RECOVERY_REVIEW_REQUIRED=true